# lawkit リブート - 問題分析

**作成日**: 2025-11-16
**リブート理由**: diffx, diffai との3兄弟プロジェクト複雑化により全て失敗中

---

## 🚨 **緊急の問題（Critical Issues）**

### 1. **ビルド完全失敗 - diffx-core依存の破損**

**現象**:
```
error: failed to load manifest for dependency `diffx-core`
failed to read `/home/user/diffx/diffx-core/Cargo.toml`
No such file or directory (os error 2)
```

**原因**:
- `lawkit-core/Cargo.toml:34` で `diffx-core = { path = "../../diffx/diffx-core" }` に依存
- diffxリポジトリが存在しないまたはアクセス不可
- ローカル開発環境でのパス依存が壊れている

**影響**:
- **cargo buildが完全に失敗**
- 開発・テスト・リリース全てが不可能
- CI/CDパイプライン停止状態

**優先度**: 🔴 **最高** - 即座の修正必須

---

### 2. **モノリポ複雑化 - lawkit-js/lawkit-python分離未完了**

**現象**:
- `lawkit-js/`, `lawkit-python/` ディレクトリがワークスペースメンバーとして残存
- 別リポジトリ（lawkit-js, lawkit-python）が既に作成済み
- 移行が中途半端な状態

**原因**:
- diffx, lawkit, diffaiの3プロジェクトで「フォルダ構成を似せた」結果、複雑化
- モノリポアプローチが保守困難に

**影響**:
- ワークスペース構造の複雑性増大
- 別リポジトリへの移行が未完了
- 開発者の認知負荷増加

**優先度**: 🟠 **高** - リブート初期で対処

---

## 📊 **重要な問題（Important Issues）**

### 3. **diffxリブート待ち状態 - 自律性の欠如**

**現象**:
- "lawkitはdiffxの改善待ちなのだ" という依存状態
- diffxがリブート中のため、lawkitも停滞

**原因**:
- diffx-core依存により、diffxの状態に強く依存
- 3兄弟プロジェクトの相互依存が過度

**影響**:
- 独立した開発・リリースサイクルの喪失
- diffxの問題がlawkitにも波及
- プロジェクトの自律性低下

**優先度**: 🟠 **高** - アーキテクチャ見直し必要

---

### 4. **過去の成功への固執 - v2.4.1以降の停滞**

**現象**:
- `.claude/tasks.md` に「v2.4.1リリース完全成功」記載
- しかし現在はビルド失敗状態
- 成功体験から前進できていない

**原因**:
- リリース成功後の次のステップ不明確
- diffx移植プロジェクト完了後の方向性喪失
- 「diffxの改善待ち」という受動的姿勢

**影響**:
- 新機能開発の停止
- コミュニティへのコミット頻度低下
- プロジェクトの活力喪失

**優先度**: 🟡 **中** - 戦略的見直し必要

---

## 🔍 **その他の問題（Minor Issues）**

### 5. **quick-check.sh の不在**

**現象**:
- `./github-shared/rust-cli-kiln/scripts/testing/quick-check.sh` が存在しない
- CLAUDE.md には「CI事前テスト必須」と記載

**原因**:
- github-sharedディレクトリ自体が存在しない
- diffxからの移植が不完全または削除済み

**影響**:
- ローカルでの品質チェックが困難
- CI/CD前の事前検証ができない

**優先度**: 🟢 **低** - github-shared非依存なら問題なし

---

### 6. **ドキュメントの過剰性**

**現象**:
- `.claude/` に10個のマークダウンファイル
- `benf-features.md`, `normal-features.md`, `zipf-features.md`, `pareto-features.md`, `poisson-features.md`
- 統計法則ごとに分割されたドキュメント

**原因**:
- 初期開発フェーズでの詳細ドキュメント作成
- 「完璧主義」的アプローチ

**影響**:
- ドキュメント保守コスト増大
- 実際のコードとの乖離リスク
- 開発者の認知負荷増加

**優先度**: 🟢 **低** - リブート後半で整理

---

## 🎯 **根本原因分析（Root Cause）**

### **3兄弟プロジェクトの過度な統合**

diffx, lawkit, diffaiの3つのプロジェクトで：
1. **フォルダ構成を似せた** → 各プロジェクトの特性を無視
2. **モノリポアプローチ** → 複雑性が管理不能に
3. **相互依存** → diffx-coreへの依存が破綻の引き金
4. **並行リブート** → 3つ同時に失敗

### **「完璧主義」による過剰設計**

- 詳細な統計法則ドキュメント作成
- github-shared共有スクリプト構想
- 多言語ドキュメント（英語・日本語・中国語）
- 実行よりも計画に注力

---

## 📋 **diffxリブートからの学び**

diffxの `.claude/reboot/problem-analysis.md` から：

1. **CI/CDパイプライン崩壊** → lawkitも同様（ビルド失敗）
2. **過度な理想主義** → 740行移行計画、200+チェックリスト
3. **マーケティング停滞** → 3ヶ月実行なし
4. **複雑すぎるリリースシステム** → 2幕構成の保守困難
5. **意味のないバージョンアップ** → 実質的変更なし

**lawkitへの適用**:
- ✅ ビルド失敗を即座に修正
- ✅ シンプルな構成に戻す
- ✅ 独立したプロジェクトとして自律
- ✅ 実行重視、完璧主義排除

---

## ✅ **次のアクション（Next Steps）**

### **Phase 0: 緊急修正（即座）**
1. diffx-core依存を削除または修正
2. ビルド成功を確認

### **Phase 1: クリーンアップ（1日）**
1. lawkit-js, lawkit-pythonを `to-migrate/` に移動
2. Cargo.tomlワークスペース構成をシンプル化

### **Phase 2: 検証（1日）**
1. ground-truth.md作成（実際に動くものを検証）
2. 最小限のテストで品質確認

### **Phase 3: 戦略策定（1日）**
1. reboot-plan.md作成
2. diffx依存からの脱却方針決定
3. 独立したロードマップ策定

---

**結論**: lawkitは現在、diffx依存により完全に機能不全。リブートの最優先事項は**ビルド回復**と**独立性の確立**。
